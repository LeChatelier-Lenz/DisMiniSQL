# 前期分工
- 语言：java

- 几个部分：
   - client（1）李光耀
   - 主节点（2）沈聪愉、陈其鹏
   - 从节点（2）吴赫峰、蔡晏辉

- 任务一：各部分研究，组内汇报
   - DDL：**下周三(4.16)下午原上课时间**
      - 讲一下大概要做什么（本部分的主要职能）
         - 额外内容的记录
      - 别的模块接口调用确认
- 任务二：各模块间接口确认（接口文档）
   ~~- DDL：下周日(4.20)晚上之前~~
  - DDL: 周五(4.18)晚上之前

# 分布式MiniSQL开发总结



## MasterServer

1. 主节点启动
    - 初始化tableManager、zookeeperManager、socketManager
    - 开启两个线程（位于不同端口）：
        - zookeeper监听线程：一个在启动时向ZooKeeper发送请求，获得ZNODE目录下的信息并持续监控，如果发生了目录的变化则执行回调函数，处理相应策略
            - 主要是用到`curator`库
        - 通信线程：负责处理与从节点、客户端的通信请求
            - 主要是`socket`

2. 后续任务

    - 与客户端交互：

        - 等待客户端的表格查询信息，返回给客户端对应的表格所在从节点的IP（还有表名），随后客户端和从节点进行交流
        - 等待客户端的表格创建信息，做负载均衡处理后返回**最佳从节点**的IP信息

    - 与从节点交互：

        - 等待从节点启动之后将其存储的表明告知主节点（没有则不用发）
        - 等待从节点的表格更改信息（增/删）

    - ZooKeeper事件监听处理

      > 主要是针对容错容灾&负载均衡处理

        - 监听到某个从节点挂掉之后，根据负载均衡找到最佳从节点，并将所有的表复制给该从节点（利用ftp）
        - 激活/重新恢复从节点时（监听到从节点上线，主节点向其发送消息）



## 几个通信关系

> 都是依靠socket通信实现的交互，所以这几个环节对好就行

- 客户端&主节点
- 从节点&主节点
- 客户端&从节点

> 其实应该还有主节点&zookeeper和从节点&zookeeper，不过这一部分没有需要严格对接的接口



